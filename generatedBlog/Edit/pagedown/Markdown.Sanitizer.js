(function(){var f,d;if(typeof exports==="object"&&typeof require==="function"){f=exports;d=require("./Markdown.Converter").Converter}else{f=window.Markdown;d=f.Converter}f.getSanitizingConverter=function(){var i=new d();i.hooks.chain("postConversion",g);i.hooks.chain("postConversion",b);return i};function g(i){return i.replace(/<[^>]*>?/gi,h)}var c=/^(<\/?(b|blockquote|code|del|dd|dl|dt|em|h1|h2|h3|i|kbd|li|ol|p|pre|s|sup|sub|strong|strike|ul)>|<(br|hr)\s?\/?>)$/i;var a=/^(<a\shref="((https?|ftp):\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+"(\stitle="[^"<>]+")?\s?>|<\/a>)$/i;var e=/^(<img\ssrc="(https?:\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+"(\swidth="\d{1,3}")?(\sheight="\d{1,3}")?(\salt="[^"<>]*")?(\stitle="[^"<>]*")?\s?\/?>)$/i;function h(i){if(i.match(c)||i.match(a)||i.match(e)){return i}else{return""}}function b(j){if(j==""){return""}var o=/<\/?\w+[^>]*(\s|$|>)/g;var u=j.toLowerCase().match(o);var q=(u||[]).length;if(q==0){return j}var r,p;var k="<p><img><br><li><hr>";var l;var s=[];var t=[];var m=false;for(var i=0;i<q;i++){r=u[i].replace(/<\/?(\w+).*/,"$1");if(s[i]||k.search("<"+r+">")>-1){continue}p=u[i];l=-1;if(!/^<\//.test(p)){for(var n=i+1;n<q;n++){if(!s[n]&&u[n]=="</"+r+">"){l=n;break}}}if(l==-1){m=t[i]=true}else{s[l]=true}}if(!m){return j}var i=0;j=j.replace(o,function(v){var w=t[i]?"":v;i++;return w});return j}})();